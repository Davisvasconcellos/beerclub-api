{
  "info": {
    "name": "BeerClub Events API",
    "description": "Coleção de endpoints de eventos (admin e públicos) com paginação, filtros e envio/export de respostas.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    { "key": "baseUrl", "value": "http://localhost:4001" },
    { "key": "token", "value": "" },
    { "key": "eventId", "value": "00000000-0000-0000-0000-000000000000" },
    { "key": "eventSlug", "value": "beer-festival-2025" },
    { "key": "questionId", "value": "1" }
  ],
  "item": [
    {
      "name": "Events Admin",
      "description": "Rotas administrativas de eventos (requer JWT).",
      "auth": {
        "type": "bearer",
        "bearer": [
          { "key": "token", "value": "{{token}}", "type": "string" }
        ]
      },
      "item": [
        {
          "name": "List Events (admin/master) - Paginação e Filtros",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/events?page=1&limit=20&order=desc&sort_by=created_at&name=&slug=&created_by=&status=&from=&to=",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "events"],
              "query": [
                { "key": "page", "value": "1" },
                { "key": "limit", "value": "20" },
                { "key": "order", "value": "desc" },
                { "key": "sort_by", "value": "created_at" },
                { "key": "name", "value": "" },
                { "key": "slug", "value": "" },
                { "key": "created_by", "value": "" },
                { "key": "status", "value": "" },
                { "key": "from", "value": "" },
                { "key": "to", "value": "" }
              ]
            },
            "description": "Lista eventos do usuário (admin) ou todos (master) com paginação, ordenação e filtros."
          }
        },
        {
          "name": "Create Event",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json", "type": "text" }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/events",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "events"]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Beer Festival 2025\",\n  \"slug\": \"beer-festival-2025\",\n  \"banner_url\": \"https://example.com/banner.jpg\",\n  \"start_datetime\": \"2025-11-20T18:00:00Z\",\n  \"end_datetime\": \"2025-11-20T22:00:00Z\",\n  \"questions\": [\n    { \"text\": \"Qual seu estilo favorito?\", \"type\": \"text\", \"is_required\": true, \"show_results\": true },\n    { \"text\": \"Selecione estilos\", \"type\": \"radio\", \"options\": [\"IPA\", \"Lager\", \"Stout\"] }\n  ]\n}"
            },
            "description": "Cria um novo evento. Campos aceitos: name, slug, banner_url, start_datetime, end_datetime e lista opcional de questions."
          }
        },
        {
          "name": "Get Event Details",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/events/{{eventId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "events", "{{eventId}}"]
            },
            "description": "Obtém detalhes de um evento por id_code (UUID)."
          }
        },
        {
          "name": "Update Event",
          "request": {
            "method": "PATCH",
            "header": [
              { "key": "Content-Type", "value": "application/json", "type": "text" }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/events/{{eventId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "events", "{{eventId}}"]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Beer Festival 2025 - Atualizado\",\n  \"slug\": \"beer-festival-2025\",\n  \"banner_url\": \"https://example.com/banner-new.jpg\"\n}"
            },
            "description": "Atualiza campos de um evento existente (parcial). Campos permitidos atualmente: name, slug, banner_url."
          }
        },
        {
          "name": "Delete Event (soft delete)",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/events/{{eventId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "events", "{{eventId}}"]
            },
            "description": "Remove (soft delete) o evento pelo id_code (UUID)."
          }
        },
        {
          "name": "List Event Questions",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/events/{{eventId}}/questions",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "events", "{{eventId}}", "questions"]
            },
            "description": "Lista perguntas do evento (ordenadas por order_index)."
          }
        },
        {
          "name": "Create Event Question",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json", "type": "text" }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/events/{{eventId}}/questions",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "events", "{{eventId}}", "questions"]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"text\": \"Qual sua bebida favorita?\",\n  \"type\": \"radio\",\n  \"options\": [\"IPA\", \"Lager\", \"Stout\"],\n  \"is_required\": true,\n  \"show_results\": true,\n  \"order_index\": 0\n}"
            },
            "description": "Cria uma nova pergunta para o evento. Tipos suportados: text, textarea, radio, checkbox, rating, music_preference."
          }
        },
        {
          "name": "Update Event Question",
          "request": {
            "method": "PATCH",
            "header": [
              { "key": "Content-Type", "value": "application/json", "type": "text" }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/events/{{eventId}}/questions/{{questionId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "events", "{{eventId}}", "questions", "{{questionId}}"]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"text\": \"Qual seu estilo favorito?\",\n  \"type\": \"checkbox\",\n  \"options\": [\"IPA\", \"Lager\", \"Stout\", \"Pilsner\"],\n  \"is_required\": false,\n  \"show_results\": true,\n  \"order_index\": 1\n}"
            },
            "description": "Atualiza uma pergunta do evento (parcial)."
          }
        },
        {
          "name": "Delete Event Question",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/events/{{eventId}}/questions/{{questionId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "events", "{{eventId}}", "questions", "{{questionId}}"]
            },
            "description": "Exclui a pergunta do evento e remove respostas relacionadas."
          }
        }
      ]
    },
    {
      "name": "Events Public",
      "description": "Rotas públicas de eventos.",
      "item": [
        {
          "name": "List Public Events - Paginação e Filtros",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/events/public?page=1&limit=20&order=desc&sort_by=start_datetime&name=&slug=&status=&from=&to=&date=",
              "host": ["{{baseUrl}}"],
              "path": ["api", "events", "public"],
              "query": [
                { "key": "page", "value": "1" },
                { "key": "limit", "value": "20" },
                { "key": "order", "value": "desc" },
                { "key": "sort_by", "value": "start_datetime" },
                { "key": "name", "value": "" },
                { "key": "slug", "value": "" },
                { "key": "status", "value": "" },
                { "key": "from", "value": "" },
                { "key": "to", "value": "" },
                { "key": "date", "value": "" }
              ]
            },
            "description": "Lista pública de eventos com paginação, ordenação e filtros (inclui filtro de data: eventos ocorrendo no dia informado)."
          }
        },
        {
          "name": "Get Public Event by Slug - Detalhes completos",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/events/public/{{eventSlug}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "events", "public", "{{eventSlug}}"]
            },
            "description": "Retorna o evento por slug com campos: id, id_code, name, slug, description, banner_url, public_url, gallery_url, place, start_datetime, end_datetime, color_1, color_2, card_background e questões visíveis."
          }
        },
        {
          "name": "List Event Responses - Paginação e Filtros",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/events/{{eventId}}/responses?page=1&limit=20&order=desc&sort_by=submitted_at&guest_code=&has_selfie=&from=&to=&question_id=&answer_contains=",
              "host": ["{{baseUrl}}"],
              "path": ["api", "events", "{{eventId}}", "responses"],
              "query": [
                { "key": "page", "value": "1" },
                { "key": "limit", "value": "20" },
                { "key": "order", "value": "desc" },
                { "key": "sort_by", "value": "submitted_at" },
                { "key": "guest_code", "value": "" },
                { "key": "has_selfie", "value": "" },
                { "key": "from", "value": "" },
                { "key": "to", "value": "" },
                { "key": "question_id", "value": "" },
                { "key": "answer_contains", "value": "" }
              ]
            },
            "description": "Lista respostas de um evento com paginação e filtros (texto em answer_text)."
          }
        },
        {
          "name": "Submit Event Responses",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json", "type": "text" }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/events/{{eventId}}/responses",
              "host": ["{{baseUrl}}"],
              "path": ["api", "events", "{{eventId}}", "responses"]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"guest_code\": \"ABC123\",\n  \"selfie_url\": \"https://example.com/selfie.jpg\",\n  \"answers\": [\n    { \"question_id\": 1, \"answer_text\": \"Sim\" },\n    { \"question_id\": 2, \"answer_json\": { \"option\": \"IPA\" } }\n  ]\n}"
            },
            "description": "Submete respostas para um evento. guest_code deve ser único. Cada resposta deve conter answer_text ou answer_json."
          }
        },
        {
          "name": "Export Event Responses CSV",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/events/{{eventId}}/responses/export",
              "host": ["{{baseUrl}}"],
              "path": ["api", "events", "{{eventId}}", "responses", "export"]
            },
            "description": "Exporta respostas do evento em CSV, com colunas dinâmicas baseadas nas perguntas (Q{id} - texto)."
          }
        }
      ]
    }
  ]
}